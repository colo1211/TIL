# 5. JSP & ë°ì´í„°ë² ì´ìŠ¤ ì—°ë™

* ì‹¤ìŠµ ì˜ˆì œ

![image](https://user-images.githubusercontent.com/63600953/208294144-379b200e-dd40-4ba5-99cf-eeae8bb07d13.png)

íšŒì›ê°€ì… í¼ ìƒì„± í›„, íšŒì›ê°€ì…ì— ì‘ì„±í•œ ë°ì´í„°ë¥¼ ì‹¤ì œ ë°ì´í„°ë² ì´ìŠ¤ì— ì €ì¥
    * íŒ¨ìŠ¤ì›Œë“œ í™•ì¸ì€ ì €ì¥ X
    * ë‹¹ì‹ ì˜ ê´€ì‹¬ë¶„ì•¼ëŠ” ë°°ì—´íƒ€ì…ìœ¼ë¡œ ì €ì¥

ğŸ’¡ JSPì—ì„œ DBë¥¼ ì‚¬ìš©í•˜ëŠ” íŒ¨í„´ 3ê°€ì§€

```
1. ë°ì´í„°ë¥¼ ë°›ì•„ì„œ JSP ë‚´ì—ì„œ DBë¥¼ ì—°ë™í•˜ëŠ” ë°©ë²•


2. JSPë¡œ ë°ì´í„°ë¥¼ ë°›ì•„ì„œ `DAO(Data Access Object)` í´ë˜ìŠ¤ë¥¼ ì´ìš©í•´ì„œ DBì— ë„£ê³  ë°›ëŠ” ë°©ë²• â­â­â­â­â­


3. Connection Pool(ì»¤ë„¥ì…˜ í’€)ì„ ì´ìš©í•˜ì—¬ DBë¥¼ ì´ìš©í•˜ëŠ” ë°©ë²•
```

ğŸ’¡ ì‹¤ìŠµ Flow
```
1. íšŒì›ê°€ì…ì„ ìœ„í•œ Form.jsp íŒŒì¼ì„ ìƒì„±í•œë‹¤.

2. DBì—ì„œ Table ì„ ìƒì„±í•œë‹¤.

3. ì²˜ë¦¬ JSPíŒŒì¼(FormProc.jsp)ì„ ë§Œë“¤ì–´ì„œ DBì— ì—°ê²°í•œ ì´í›„, ì €ì¥

4. íšŒì› ì „ì²´ë³´ê¸° í˜ì´ì§€ë¥¼ ë§Œë“¤ì–´ì„œ DBì—ì„œ íšŒì› ì „ì²´ ë³´ê¸°

5. íšŒì› ìˆ˜ì • / ì‚­ì œ
```

`Ojdbc14.jar` <br/>
* JSPì™€ ì˜¤ë¼í´ì„ ì ‘ì†í•´ì£¼ëŠ” í´ë˜ìŠ¤ê°€ ë“¤ì–´ê°€ìˆëŠ” ë¬¶ìŒ
* ìë°”ëŠ” ì˜¤ë¼í´ì„ ì§€ì›í•˜ì§€ ì•ŠìŒ, ê·¸ê²ƒì„ ì—°ê²°í•´ì£¼ëŠ” ê²ƒì´ `Ojdbc14.jar`

`Ojdbc6.jar` <br/>
* Ojdbc14.jar ì´ ì§€ì›í•˜ëŠ” ê²ƒë“¤ì„ í¬í•¨
* `ì»¤ë„¥ì…˜ í’€`ì„ ì´ìš©í•˜ì—¬ ì˜¤ë¼í´ì„ ì´ìš©í•˜ê¸° ìœ„í•´ì„œëŠ” í•´ë‹¹ í´ë˜ìŠ¤ë¥¼ ì‚¬ìš©

[Ojdbc6 ë‹¤ìš´ë¡œë“œ](https://joongwoonc.tistory.com/51)
* ì•„íŒŒì¹˜ í†°ìº£ì´ ì„¤ì¹˜ë˜ì–´ìˆëŠ” í´ë”ë¡œ ì´ë™ í›„, lib í´ë”ë¡œ ì´ë™í•œ ì´í›„ í•´ë‹¹ íŒŒì¼ì„ ë¶™ì—¬ë„£ëŠ”ë‹¤.
* ì„¤ì¹˜ëœ ìœ„ì¹˜ ì°¾ëŠ” ë²• : ì´í´ë¦½ìŠ¤ > Preference > Server > Runtime Enviroment > Edit


## DAO
* Database Access Object
* ìš°ì„  JSP ë‚´ë¶€ì—ì„œ DBì—°ê²° ì„±ê³µ í™•ì¸ ì´í›„ì— DAOë¡œ ë¶„ë¦¬ ì§„í–‰
* JSPì—ì„œ DBì—°ê²° ìë°” ì½”ë“œë¥¼ ì¤„ì´ê¸° ìœ„í•´ì„œ í•˜ë‚˜ì˜ ìë°”íŒŒì¼ì— ëª°ì•„ì„œ ë©”ì†Œë“œë¥¼ í˜¸ì¶œí•˜ëŠ” ë°©ì‹
  * í˜‘ì—…ì— ìœ ë¦¬, ë””ìì´ë„ˆ/ê°œë°œì 
  * ìœ„ì¹˜ : `Java Resource>model>MemeberDAO.java`
  ![image](https://user-images.githubusercontent.com/63600953/210241618-8258b12c-6a83-450d-99e9-7029bbc1b7b3.png)

`DAO.java`
* ì•„ë˜ì™€ ê°™ì´ DB ê´€ë ¨ ìë°” ì½”ë“œë¥¼ DAO.java íŒŒì¼ì— ëª¨ë‘ ë„£ì–´ì¤€ë‹¤.
```
package model;

import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.ResultSet;

// JSP ì—ì„œ DBì— ì ‘ê·¼ ê´€ë ¨í•œ ìë°” ì½”ë“œë¥¼ ë§ì´ ë„£ìœ¼ë©´ ë„ˆë¬´ ì½”ë“œê°€ ë³µì¡í•´ì§„ë‹¤. ë”°ë¼ì„œ, ìë°” DB ì ‘ê·¼ ê´€ë ¨ í´ë˜ìŠ¤ë¥¼ ëª¨ì•„ë†“ì€ í´ë˜ìŠ¤ê°€ DAO í´ë˜ìŠ¤
// ì˜¤ë¼í´ DBì— ì—°ê²°í•˜ê³  SELECT, INSERT, UPDATE, DELETE ì‘ì—…ì„ ì‹¤í–‰í•´ì£¼ëŠ” í´ë˜ìŠ¤
// Data Access Object
public class MemberDAO {
	
	
	// ì˜¤ë¼í´ì— ì ‘ì†í•˜ëŠ” ì†ŒìŠ¤ë¥¼ ì‘ì„±
	String id = "";
	String pass="";
	String url="jdbc:oracle:thin:@localhost:1521:XE"; // ì ‘ì† URL, XE : ì „ì—­ ë°ì´í„° ë² ì´ìŠ¤
	
	Connection con; //ë°ì´í„°ë² ì´ìŠ¤ì— ì ‘ê·¼í•  ìˆ˜ ìˆë„ë¡ ì„¤ì •
	PreparedStatement pstmt; // ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ ì¿¼ë¦¬ë¥¼ ì‹¤í–‰ì‹œì¼œì£¼ëŠ” ê°ì²´
	ResultSet rs; // Selectì‹œ, í…Œì´ë¸”ì˜ ê²°ê³¼ë¥¼ ë¦¬í„´ë°›ì•„ ìë°”ì— ì €ì¥í•´ì£¼ëŠ” ê°ì²´ 
	
	
	// ë°ì´í„° ë² ì´ìŠ¤ì— ì ‘ê·¼í•  ìˆ˜ ìˆë„ë¡ ë„ì™€ì£¼ëŠ” ë©”ì†Œë“œ
	public void getCon() {
		
		try {
			//1. í•´ë‹¹ ë°ì´í„° ë² ì´ìŠ¤ë¥¼ ì‚¬ìš©í•œë‹¤ê³  ì„ ì–¸(í´ë˜ìŠ¤ë¥¼ ë“±ë¡ = ì˜¤ë¼í´ìš©ì„ ì‚¬ìš©), MySqlì€ ë‹¤ë¥¸ ì½”ë“œ
			// Oracleê³¼ JSPë¥¼ ì—°ê²°í•´ì£¼ëŠ” ì½”ë“œ ojdbc6.jar íŒŒì¼ ë‚´ë¶€ì— OracleDriver.class íŒŒì¼ ì¡´ì¬
			Class.forName("oracle.jdbc.driver.OracleDriver"); 
			
			// 2. í•´ë‹¹ ë°ì´í„° ë² ì´ìŠ¤ì— ì ‘ì†, java.sqlì— ìˆëŠ” connection
			con = DriverManager.getConnection(url, id, pass);
		}catch(Exception e) {
			
		}
	}
	
	// ë°ì´í„°ë² ì´ìŠ¤ì— í•œì‚¬ëŒì˜ íšŒì› ì •ë³´ë¥¼ ì €ì¥í•´ì£¼ëŠ” ë©”ì†Œë“œ
	public void insertMember(MemberBean mbean) {
		try{
			
			// ì—°ê²° ë©”ì†Œë“œë¥¼ ì‚¬ìš©
			getCon();
			
			// 3. ì ‘ì† í›„, ì¿¼ë¦¬ ì¤€ë¹„
			String sql = "insert into member values(?,?,?,?,?,?,?,?)";
			
			// 4. ì¿¼ë¦¬ë¥¼ ì‚¬ìš©í•˜ë„ë¡ ì„¤ì •
			PreparedStatement pstmt = con.prepareStatement(sql); // jspì—ì„œ ì¿¼ë¦¬ë¥¼ ì‚¬ìš©í•˜ë„ë¡ ì„¤ì •
			
			// ?ì— ë§ê²Œ ë°ì´í„°ë¥¼ ë§¤í•‘ => prepareStatementì˜ ê·œì¹™
			pstmt.setString(1, mbean.getId()); // ì²«ë²ˆì§¸ ë¬¼ìŒí‘œ
			pstmt.setString(2, mbean.getPass1());
			pstmt.setString(3, mbean.getEmail());
			pstmt.setString(4, mbean.getTell());
			pstmt.setString(5, mbean.getHobby());
			pstmt.setString(6, mbean.getJob());
			pstmt.setString(7, mbean.getAge());
			pstmt.setString(8, mbean.getInfo());
			
			// 5. ì˜¤ë¼í´ì—ì„œ ì¿¼ë¦¬ë¥¼ ì‹¤í–‰í•˜ì‹œì˜¤
			pstmt.executeUpdate(); // insert,update,delete ì‹œ ì‚¬ìš©í•˜ëŠ” ë©”ì†Œë“œ & ê²°ê³¼ë¥¼ ë°›ì•„ì˜¬ ë•Œ(ì¡°íšŒ)ëŠ” excuteQuery()
			// Insert, Update, Delete : executeUpdate()
			// Read : executeQuery()
			
			// 6. ìì› ë°˜ë‚©
			con.close();
			
		}catch(Exception e){
			e.printStackTrace();
		}
	}
	
}

```

`MemberJoinProc.jsp`
* ë‹¨ ë‘ ì¤„ë¡œ JSP ë‚´ì—ì„œ ë©”ì†Œë“œë¥¼ í˜¸ì¶œí•´ì„œ íšŒì›ê°€ì… ì½”ë“œë¥¼ ë§ˆë¬´ë¦¬ ì§€ì„ ìˆ˜ ìˆìŒ
```
	MemberDAO mdao = new MemberDAO(); // í´ë˜ìŠ¤ ì•ˆì—ìˆëŠ” ë©”ì†Œë“œë¥¼ ì‹¤í–‰í•˜ê¸° ìœ„í•´ì„œ ì¸ìŠ¤í„´ìŠ¤ ìƒì„±
	mdao.insertMember(mbean);
```

